button_card_templates:
  !include_dir_merge_named button_card_templates

kiosk_mode:
  hide_header: true
  hide_sidebar: false

views:
  - title: Home
    type: masonry
    icon: mdi:home
    path: home
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: menu
          - type: action
            tap_action:
              action: navigate
              navigation_path: /lovelace/smartmeter
            icon: mdi:speedometer
          - type: action
            tap_action:
              action: navigate
              navigation_path: /lovelace/cameras
            icon: mdi:cctv
          - type: action
            tap_action:
              action: navigate
              navigation_path: /lovelace/system
            icon: mdi:cog

      - type: horizontal-stack
        cards:
          - type: custom:mushroom-person-card
            entity: person.thijs
            name: Thijs
          - type: custom:mushroom-person-card
            entity: person.sal
            name: Sal
      - square: false
        type: grid
        cards:
          - type: custom:mushroom-template-card
            primary: Living Room
            icon: mdi:sofa
            secondary: >-
              {{ "ðŸŒ¡ï¸ " ~ states("sensor.living_room_temperature_temperature") ~
              " Â°C  ðŸ’§ " ~ states("sensor.living_room_temperature_humidity") ~
              "%" }}
            tap_action:
              action: navigate
              navigation_path: /lovelace/living-room
            badge_color: ''
            icon_color: |-
              {% if is_state('light.living_room_dimmer', 'on') %}
                orange
              {% else %}
                grey
              {% endif %}
            hold_action:
              action: more-info
          - type: custom:mushroom-template-card
            primary: Hallway
            icon: mdi:coat-rack
            tap_action:
              action: navigate
              navigation_path: /lovelace/hallway
            badge_color: red
            icon_color: |
              {% if is_state('switch.hallway_light_switch', 'on') %}
                orange
              {% else %}
                grey
              {% endif %}
            hold_action:
              action: more-info
            secondary: '{{states("sensor.hallway_motion_sensor_illuminance")}} lx'
            badge_icon: >-
              {% if is_state('binary_sensor.hallway_motion_sensor_occupancy',
              'on') %}
                mdi:motion-sensor
              {% endif %}
          - type: custom:mushroom-template-card
            primary: Bathroom
            icon: mdi:bathtub
            secondary: >-
              {{ "ðŸŒ¡ï¸ " ~ states("sensor.bathroom_temperature_temperature") ~ "
              Â°C  ðŸ’§ " ~ states("sensor.bathroom_temperature_humidity") ~ "%" }}
            badge_color: ''
            hold_action:
              action: more-info
            tap_action:
              action: navigate
              navigation_path: /lovelace/bathroom
            icon_color: grey
          - type: custom:mushroom-template-card
            primary: Bedroom
            icon: mdi:bed
            secondary: >-
              {{ "ðŸŒ¡ï¸ " ~ states("sensor.bedroom_temperature_temperature") ~ "
              Â°C  ðŸ’§ " ~ states("sensor.bedroom_temperature_humidity") ~ "%" }}
            badge_color: ''
            hold_action:
              action: more-info
            tap_action:
              action: navigate
              navigation_path: /lovelace/bedroom
            icon_color: grey
          - type: custom:mushroom-template-card
            primary: Office
            icon: mdi:desk
            secondary: >-
              {{ "ðŸŒ¡ï¸ " ~ states("sensor.office_temperature_temperature") ~ "
              Â°C  ðŸ’§ " ~ states("sensor.office_temperature_humidity") ~ "%" }}
            badge_color: ''
            hold_action:
              action: more-info
            tap_action:
              action: navigate
              navigation_path: /lovelace/office
            icon_color: |-
              {% if is_state('light.office_ceiling_lamp_01', 'on') %}
                orange
              {% else %}
                grey
              {% endif %}
          - type: custom:mushroom-template-card
            primary: Backyard
            icon: mdi:flower
            tap_action:
              action: navigate
              navigation_path: /lovelace/backyard
            badge_color: red
            hold_action:
              action: more-info
            badge_icon: >-
              {% if is_state('binary_sensor.binary_sensor.backyard_all_occupancy', 'on') %}
                mdi:motion-sensor
              {% endif %}
        columns: 2
        title: Rooms
  - type: masonry
    path: living-room
    title: Living Room
    icon: mdi:sofa
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: back
          - type: entity
            entity: sensor.living_room_temperature_temperature
            use_entity_picture: false
            icon: mdi:thermometer
          - type: light
            entity: light.living_room_dimmer
            icon: mdi:lightbulb
            use_light_color: false
          - type: light
            entity: light.dining_room_dimmer
            icon: mdi:lightbulb
      - type: custom:advanced-camera-card
        cameras:
          - camera_entity: camera.living
      - type: horizontal-stack
        cards:
          - type: custom:mini-graph-card
            name: Temperature
            entities:
              - entity: sensor.living_room_temperature_temperature
                name: Temperature
            show:
              fill: true
            hours_to_show: 12
            points_per_hour: 2
          - type: custom:mini-graph-card
            name: Humidity
            entities:
              - entity: sensor.living_room_temperature_humidity
                name: Humidity
            show:
              fill: true
            hours_to_show: 12
            points_per_hour: 2
            line_color: blue
      - square: false
        type: grid
        cards:
          - type: custom:mushroom-light-card
            entity: light.living_room_dimmer
            icon: mdi:sofa
            name: Living Room
            show_brightness_control: true
            show_color_control: false
            use_light_color: false
            collapsible_controls: true
          - type: custom:mushroom-light-card
            entity: light.dining_room_dimmer
            icon: mdi:table-furniture
            name: Dining Room
            show_brightness_control: true
            collapsible_controls: true
        columns: 2
        title: Lights
    subview: true
  - type: masonry
    path: hallway
    title: Hallway
    icon: mdi:coat-rack
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: back
          - type: entity
            entity: sensor.hallway_motion_sensor_illuminance
            icon: mdi:brightness-5
            use_entity_picture: false
          - type: entity
            entity: binary_sensor.hallway_motion_sensor_occupancy
            use_entity_picture: false
      - type: custom:advanced-camera-card
        cameras:
          - camera_entity: camera.driveway
      - square: false
        type: grid
        cards:
          - type: custom:mushroom-light-card
            entity: light.hallway_light
            icon: mdi:lightbulb
            name: Hallway
            show_brightness_control: false
            show_color_control: false
            use_light_color: false
            collapsible_controls: true
          - type: custom:mushroom-entity-card
            entity: binary_sensor.hallway_motion_sensor_occupancy
            name: Occupancy
          - type: custom:mushroom-entity-card
            entity: sensor.hallway_motion_sensor_illuminance
            name: Illuminance
        columns: 2
    subview: true
  - type: masonry
    title: Backyard
    path: backyard
    icon: mdi:flower
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: back
      - type: custom:advanced-camera-card
        cameras:
          - camera_entity: camera.backyard
      - square: false
        type: grid
        cards:
          - type: custom:mushroom-entity-card
            entity: binary_sensor.backyard_person_occupancy
            name: Person occupancy
            icon: mdi:account
            icon_color: |-
              {% if is_state('binary_sensor.backyard_person_occupancy', 'on') %}
                orange
              {% else %}
                grey
              {% endif %}
          - type: custom:mushroom-entity-card
            entity: binary_sensor.backyard_dog_occupancy
            icon: mdi:dog
            name: Dog occupancy
            icon_color: |-
              {% if is_state('binary_sensor.backyard_dog_occupancy', 'on') %}
                orange
              {% else %}
                grey
              {% endif %}
          - type: custom:mushroom-entity-card
            entity: binary_sensor.backyard_cat_occupancy
            icon: mdi:cat
            name: Cat occupancy
            icon_color: |-
              {% if is_state('binary_sensor.backyard_cat_occupancy', 'on') %}
                orange
              {% else %}
                grey
              {% endif %}
        columns: 2
    subview: true
  - type: masonry
    path: bathroom
    title: Bathroom
    icon: mdi:bathtub
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: back
      - type: horizontal-stack
        cards:
          - type: custom:mini-graph-card
            name: Temperature
            entities:
              - entity: sensor.bathroom_temperature_temperature
                name: Temperature
            show:
              fill: true
            hours_to_show: 12
            points_per_hour: 2
          - type: custom:mini-graph-card
            name: Humidity
            entities:
              - entity: sensor.bathroom_temperature_humidity
                name: Humidity
            show:
              fill: true
            hours_to_show: 12
            points_per_hour: 2
            line_color: blue
    subview: true
  - type: masonry
    title: Bedroom
    path: bedroom
    icon: mdi:bed
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: back
      - type: horizontal-stack
        cards:
          - type: custom:mini-graph-card
            name: Temperature
            entities:
              - entity: sensor.bedroom_temperature_temperature
                name: Temperature
            show:
              fill: true
            hours_to_show: 12
            points_per_hour: 2
          - type: custom:mini-graph-card
            name: Humidity
            entities:
              - entity: sensor.bedroom_temperature_humidity
                name: Humidity
            show:
              fill: true
            hours_to_show: 12
            points_per_hour: 2
            line_color: blue
    subview: true
  - type: masonry
    path: office
    title: Office
    icon: mdi:desk
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: back
      - type: horizontal-stack
        cards:
          - type: custom:mini-graph-card
            name: Humidity
            entities:
              - entity: sensor.office_temperature_temperature
                name: Humidity
            show:
              fill: true
            hours_to_show: 12
            points_per_hour: 2
          - type: custom:mini-graph-card
            name: Temperature
            entities:
              - entity: sensor.office_temperature_humidity
                name: Temperature
            show:
              fill: true
            hours_to_show: 12
            points_per_hour: 2
            line_color: blue
    subview: true
  - type: masonry
    path: smartmeter
    title: Smartmeter
    icon: mdi:lightning-bolt
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: back
      - type: custom:modern-circular-gauge
        entity: sensor.currently_energy_delivered_watt
        secondary: {}
        tertiary: {}
        min: 0
        needle: true
        start_from_zero: false
        show_state: true
        show_unit: true
        adaptive_state_color: false
        header_position: top
        smooth_segments: true
        show_header: true
        show_icon: false
        adaptive_icon_color: true
        segments:
          - from: 0
            color:
              - 143
              - 255
              - 50
          - from: 800
            color:
              - 255
              - 228
              - 50
          - from: 1500
            color:
              - 196
              - 0
              - 0
        max: 2000
        name: Current Usage
        gauge_foreground_style:
          opacity: 1
          width: 8
        gauge_background_style:
          opacity: 1
          width: 4
      - type: custom:apexcharts-card
        experimental:
          color_threshold: true
        graph_span: 1h
        show:
          last_updated: true
        apex_config:
          yaxis:
            - id: first
              forceNiceScale: true
              decimalsInFloat: 3
          fill:
            type: solid
            opacity: 0.25
        header:
          standard_format: false
          show: true
          show_states: true
          colorize_states: true
          title: Past hour - median per minute
        series:
          - entity: sensor.currently_energy_delivered_watt
            name: Usage
            type: area
            group_by:
              func: median
              duration: 1m
            stroke_width: 4
          - entity: sensor.currently_energy_returned_watt
            name: Return
            type: line
            group_by:
              func: median
              duration: 1m
            stroke_width: 4
      - type: custom:apexcharts-card
        graph_span: 24h
        span:
          start: day
        header:
          show: true
          title: Usage last 24 hours
        apex_config:
          yaxis:
            - id: first
              forceNiceScale: true
              decimalsInFloat: 2
              opposite: false
              name: Energie
        series:
          - entity: sensor.energy_usage_peak_hourly
            unit: kWh
            type: column
            name: High tariff usage
            color: "#EF810E"
            group_by:
              func: max
            show:
              datalabels: false
              extremas: false
          - entity: sensor.energy_usage_offpeak_hourly
            unit: kWh
            type: column
            name: Low tariff usage
            color: "#053752"
            group_by:
              func: max
            show:
              datalabels: false
              extremas: false
      - type: energy-distribution
        link_dashboard: true
      - type: vertical-stack
        cards:
          - type: custom:mushroom-entity-card
            entity: sensor.smartmeter_mac_address
          - type: custom:mushroom-entity-card
            entity: sensor.smartmeter_ip_address
          - type: custom:mushroom-entity-card
            entity: sensor.smartmeter_startup_time
          - type: custom:mushroom-entity-card
            entity: sensor.smartmeter_wifi_signal_strength_rssi
          - type: custom:mushroom-entity-card
            entity: sensor.smartmeter_firmware_running_version
          - type: custom:mushroom-entity-card
            entity: sensor.smartmeter_firmware_available_version
          - type: custom:mushroom-entity-card
            entity: sensor.smartmeter_firmware_update_available
          - type: custom:mushroom-entity-card
            entity: switch.smartmeter_install_firmware_update
          - type: custom:mushroom-entity-card
            entity: sensor.smartmeter_lastchanged
          - type: custom:mushroom-entity-card
            entity: binary_sensor.smartmeter_connectivity_status
  - type: masonry
    path: cameras
    title: Cameras
    icon: mdi:cctv
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: back
      - type: vertical-stack
        cards:
          - type: custom:advanced-camera-card
            cameras:
              - camera_entity: camera.living
          - type: custom:advanced-camera-card
            cameras:
              - camera_entity: camera.backyard
      - type: vertical-stack
        cards:
          - type: custom:mushroom-entity-card
            entity: sensor.driveway_last_notification
          - type: custom:mushroom-entity-card
            entity: sensor.backyard_last_notification
          - type: custom:mushroom-entity-card
            entity: counter.daily_driveway_notifications
          - type: custom:mushroom-entity-card
            entity: counter.daily_backyard_notifications
          - type: custom:mushroom-entity-card
            entity: sensor.driveway_weekly_detections
          - type: custom:mushroom-entity-card
            entity: sensor.backyard_weekly_detections
          - type: custom:mushroom-entity-card
            entity: input_text.driveway_notification_history
          - type: custom:mushroom-entity-card
            entity: input_text.backyard_notification_history
  - type: masonry
    path: system
    title: System
    icon: mdi:desktop-classic
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: back
      - type: vertical-stack
        cards:
          - type: conditional
            conditions:
              - entity: input_boolean.restart_required
                state: 'on'
            card:
              type: custom:button-card
              name: Restart Home Assistant
              icon: mdi:restart
              color_type: icon
              color: red
              tap_action:
                action: call-service
                confirmation:
                  text: "Restart Home Assistant now?"
                service: script.restart_homeassistant
              styles:
                card:
                  - padding: 12px
                name:
                  - font-weight: 600
                icon:
                  - width: 32px
                  - height: 32px

          - type: custom:button-card
            name: Git Pull
            icon: mdi:git
            color_type: icon
            color: var(--primary-color)
            tap_action:
              action: call-service
              service: script.git_pull
            styles:
              card:
                - padding: 12px
              name:
                - font-weight: 600
              icon:
                - width: 32px
                - height: 32px

